---
title: "Regression Models"
author: "Jill Beck"
date: "April 3, 2016"
output: html_document
---

## Executive Summary

You work for Motor Trend, a magazine about the automobile industry. Looking at a data set of a collection of cars, they are interested in exploring the relationship between a set of variables and miles per gallon (MPG) (outcome). They are particularly interested in the following two questions:

* “Is an automatic or manual transmission better for MPG?”

* “Quantify the MPG difference between automatic and manual transmissions?”

Based on the final model fitting results, we can conclude that:

1. As wt increases per 1000lb (0.5 tons), MPG decreases by 2.5.
2. MPG will decrease very slighly with an increase in horsepower (HP).
3. 'cyl' increases from 4 to 6 to 8. This will cause MPG to decrease respectively by 3 and 2 times.
4. Automatic gearing has higher MPG when compared to manual gearing.

## Data Analysis

```{r}
library(ggplot2)
data(mtcars)
attach(mtcars)
```

This first look at the data shows us that horsepower and MPG are inversely related and manual transmission cars are generally more fuel efficient.

```{r}
mtcars$amf[am==0]='AUT'
mtcars$amf[am==1]='MAN'
print(qplot(x=wt, y=mpg, colour=am, facets=.~amf, data=mtcars,main="MPG vs. Weight/Gearing"))
```

The initial observation is that cars with a manual transmission tend to use a smaller amount of fuel and weigh less.

## Creating The Model
We will perform linear regression with all variables, and then perfom stepwise model selection to select best predictors. The final model will incorporate 'cyl', 'wt', 'hp' and 'am'.

```{r}
fit<-glm(mpg~as.factor(cyl) + as.factor(vs) + as.factor(am) + as.factor(gear) + as.factor(carb) + disp + hp + drat + wt + qsec, data=mtcars)
library(MASS)
step <- stepAIC(fit, direction="both")
step$anova
```

## Conclusions
Based on the final results, we can conclude that:

1. As wt increases per 1000lb (0.5 tons), MPG decreases by 2.5.
2. MPG will decrease very slighly with an increase in horsepower.
3. 'cyl' increases from 4 to 6 to 8. This will cause MPG to decrease respectively by 3 and 2 times.
4. Automatic gearing has higher MPG when compared to manual gearing.

## Appendix

### Initial Explorations

```{r}
plot(hp, mpg, pch=am,col=259,bg=7,
  xlab="Horsepower", cex=1.2,
  ylab="Miles per gallon", main="MPG vs. HP/Gearing")
legend("topright", c("AUT","MAN"), pch=c(0,1))
```

### Final Model

```{r}
fit2<-glm(mpg ~ as.factor(cyl) + as.factor(am) + hp + wt, data=mtcars)
layout(matrix(c(1,2,3,4),2,2)) 
plot(fit2)
```
